jQuery(document).ready((function(a){var e,t=["","فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"];function n(a){return a%4==0&&a%100!=0||a%400==0&&a%100==0}function i(a,e,t){var i,m=[31,28,31,30,31,30,31,31,30,31,30,31],l=[31,29,31,30,31,30,31,31,30,31,30,31],o=[0,0,31,62,93,124,155,186,216,246,276,306,336,365][parseInt(e)]+parseInt(t),r=parseInt(a)+621;if(o>286&&r++,n(r-1)&&286<o&&o--,o>286?o-=286:o+=79,n(r))for(i=0;o>l[i];i++)o-=l[i];else for(i=0;o>m[i];i++)o-=m[i];return++i<10&&(i="0"+i),[r,i,o]}function m(a,e,t){var i,m,l,o,r=[31,31,31,31,31,31,30,30,30,30,30,29],p=[0,0,31,59,90,120,151,181,212,243,273,304,334,365][parseInt(e)]+parseInt(t),v=n(a),s=n(a-1);if(p>79)for(i=v?p-78:p-79,l=a-621,o=0;i>r[o];o++)i-=r[o];else{if(i=s||v&&e>2?287+p:286+p,l=a-622,!1===s&&366===i)return[l,12,30];for(o=0;i>r[o];o++)i-=r[o]}return[l,m=(m=++o)<10?m="0"+m:m,i]}function l(a,e,n,i,m){for(var l='<div class="timestamp-wrap persian"><select id="mma" name="mma">',o=1;o<13;o++)o===parseInt(e)?l+='<option value="'+o+'" selected="selected">'+t[o]+"</option>":l+='<option value="'+o+'">'+t[o]+"</option>";return l+='</select><input type="text" id="jja" name="jja" value="'+n+'" size="2" maxlength="2" autocomplete="off" />,<input type="text" id="aaa" name="aaa" value="'+a+'" size="4" maxlength="4" autocomplete="off" /> در <input type="text" id="hha" name="hha" value="'+i+'" size="2" maxlength="2" autocomplete="off" /> : <input type="text" id="mna" name="mna" value="'+m+'" size="2" maxlength="2" autocomplete="off" /></div>'}function o(){var t=a("#timestamp b").text(),n=a("#mma option:selected").text()+" "+a("#jja").val()+", "+a("#aaa").val()+" در "+a("#hha").val()+":"+a("#mna").val();t!=(n=n.replace(/\d+/g,(function(a){for(var e="",t=0,n=a.length;t<n;t++)e+=String.fromCharCode(a.charCodeAt(t)+1728);return e})))&&(a("#timestamp b").html(n),clearInterval(e))}a(".wp-editor-wrap.html-active #content").css("direction","ltr"),a("a.edit-timestamp").on("click",(function(){a(".persian").remove();var e=m(a("#aa").val(),a("#mm").val(),a("#jj").val()),t=l(e[0],e[1],e[2],a("#hh").val(),a("#mn").val());a("#timestampdiv").prepend(t),a("#timestampdiv .timestamp-wrap:eq(1)").hide()})),a("#the-list").on("click",".editinline",(function(){var e=a(this).closest("td"),t=e.find(".aa").html();if(t>1400){var n=e.find(".mm").html(),i=e.find(".jj").html(),o=e.find(".hh").html(),r=e.find(".mn").html(),p=m(t,n,i);a(".persian").remove(),a(".inline-edit-date").prepend(l(p[0],p[1],p[2],o,r)),a(".inline-edit-date div:eq(1)").hide()}})),a("#timestampdiv,.inline-edit-date").on("keyup","#hha",(function(){a("input[name=hh]").val(a(this).val())})).on("keyup","#mna",(function(){a("input[name=mn]").val(a(this).val())})).on("keyup","#aaa , #jja",(function(){var e=a("#aaa").val(),t=a("#mma").val(),n=a("#jja").val();date=i(e,t,n),a("input[name=aa]").val(date[0]),a("select[name=mm]").val(date[1]),a("input[name=jj]").val(date[2])})).on("change","#mma",(function(){var e=a("#aaa").val(),t=a("#mma").val(),n=a("#jja").val();date=i(e,t,n),a("input[name=aa]").val(date[0]),a("select[name=mm]").val(date[1]),a("input[name=jj]").val(date[2])})),a("select[name=m]").hide(),a("#timestampdiv").on("keypress",(function(a){13==a.which&&(e=setInterval((function(){o()}),50))})),a(".save-timestamp , .cancel-timestamp , #publish").on("click",(function(){a("#aaa").length&&(e=setInterval((function(){o()}),50))}))}));
